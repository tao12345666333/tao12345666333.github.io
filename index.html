<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>MoeLove</title><meta name=renderer content="webkit"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta http-equiv=cache-control content="no-transform"><meta http-equiv=cache-control content="no-siteapp"><meta name=theme-color content="#f8f5ec"><meta name=msapplication-navbutton-color content="#f8f5ec"><meta name=apple-mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-status-bar-style content="#f8f5ec"><script async src=//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script><script>(adsbygoogle=window.adsbygoogle||[]).push({google_ad_client:"ca-pub-1876963677156202",enable_page_level_ads:true});</script><meta name=author content="张晋涛"><meta name=description content="Jintao Zhang's Blog MoeLove. Container, Docker, Go, Kubernetes, Python, Vim."><meta name=keywords content="MoeLove,Linux,Docker,Kubernetes,Golang,Python,Container,Vim,容器,k8s"><meta name=baidu-site-verification content="jO2rMlnjJi"><meta name=google-site-verification content="googlefe3fc086c62f7210.html"><meta name=generator content="Hugo 0.55.6"><link rel=canonical href=https://moelove.info/><link href=https://moelove.info/index.xml rel=alternate type=application/rss+xml title=MoeLove><link href=https://moelove.info/index.xml rel=feed type=application/rss+xml title=MoeLove><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/manifest.json><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link href="/dist/even.min.css?v=3.2.0" rel=stylesheet><link href=/lib/fancybox/jquery.fancybox-3.1.20.min.css rel=stylesheet><meta property="og:title" content="MoeLove"><meta property="og:description" content="Jintao Zhang's Blog MoeLove. Container, Docker, Go, Kubernetes, Python, Vim."><meta property="og:type" content="website"><meta property="og:url" content="https://moelove.info/"><meta property="og:updated_time" content="2020-03-26T22:32:31+08:00"><meta itemprop=name content="MoeLove"><meta itemprop=description content="Jintao Zhang's Blog MoeLove. Container, Docker, Go, Kubernetes, Python, Vim."><meta name=twitter:card content="summary"><meta name=twitter:title content="MoeLove"><meta name=twitter:description content="Jintao Zhang's Blog MoeLove. Container, Docker, Go, Kubernetes, Python, Vim."><!--[if lte IE 9]><script src=https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js></script><![endif]--><!--[if lt IE 9]><script src=https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js></script><script src=https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js></script><![endif]--></head><body><div id=mobile-navbar class=mobile-navbar><div class=mobile-header-logo><a href=/ class=logo>MoeLove</a></div><div class=mobile-navbar-icon><span></span><span></span><span></span></div></div><nav id=mobile-menu class="mobile-menu slideout-menu"><ul class=mobile-menu-list><a href=/about/><li class=mobile-menu-item>About</li></a><a href=/friends/><li class=mobile-menu-item>Friends</li></a><a href=/projects/><li class=mobile-menu-item>Projects</li></a><a href=/post/><li class=mobile-menu-item>Archives</li></a><a href=/tags/><li class=mobile-menu-item>Tags</li></a></ul></nav><div class=container id=mobile-panel><header id=header class=header><div class=logo-wrapper><a href=/ class=logo>MoeLove</a></div><nav class=site-navbar><ul id=menu class=menu><li class=menu-item><a class=menu-item-link href=/about/>About</a></li><li class=menu-item><a class=menu-item-link href=/friends/>Friends</a></li><li class=menu-item><a class=menu-item-link href=/projects/>Projects</a></li><li class=menu-item><a class=menu-item-link href=/post/>Archives</a></li><li class=menu-item><a class=menu-item-link href=/tags/>Tags</a></li></ul></nav></header><main id=main class=main><div class=content-wrapper><div id=content class=content><section id=posts class=posts><article class=post><header class=post-header><h1 class=post-title><a class=post-link href=/2020/03/26/Docker-7-%E5%91%A8%E5%B9%B4%E7%94%9F%E6%97%A5%E5%BF%AB%E4%B9%90/>Docker 7 周年，生日快乐！</a></h1><div class=post-meta><span class=post-time>2020-03-26</span></div></header><div class=post-content><div class=post-summary>Docker 7 岁啦！文末有活动链接~
2013 年 Docker 首次在 PyCon 上亮相，随后在 Hacker News 上引起了强烈的反响。之后在 GitHub 上正式开源，从此正式开启了 Docker 的时代。
时至今日，无论我们在谈论容器，Kubernetes 或是这整个生态中的其他产品和技术，不可避免的都会用到与 Docker 相关的知识。
毫不夸张的说，Docker 改变了世界开发部署应用程序的方式！
3 月是 Docker 的生日月，按照 Docker 社区的传统，在本月会举办一次活动来庆祝 Docker 的生日。
活动信息 本次的活动通过 3 小时的在线直播来完成，将于北京时间 3 月 27 日 00:00 开始。
直播地址是：https://youtu.be/3UZ0TUPP0ks
简单分享点 Docker 目前的进展 我自 Docker v0.9 版本开始了自己的 Docker 之路，它是我使用最频繁的工具之一。
除了是 Docker 的重度用户外，我也一直参与着 Docker 社区的上游贡献。目前在 Docker 的核心仓库贡献者排行榜中在 top90 。（很早以前我一度以为这个排行榜不会更新 hhh），以下是 Docker 的核心上游仓库本月的概览：
可以看到社区还是很活跃的，而且 Docker 目前将重点放在提升开发者体验上，今年相继推出了 Docker Desktop 新版本， Docker 首个官方 GitHub Action， 以及开源了 awesome-compose 提供了众多精选的 compose 示例，帮助开发者更快的部署容器化应用。</div><div class=read-more><a href=/2020/03/26/Docker-7-%E5%91%A8%E5%B9%B4%E7%94%9F%E6%97%A5%E5%BF%AB%E4%B9%90/ class=read-more-link>阅读更多</a></div></div></article><article class=post><header class=post-header><h1 class=post-title><a class=post-link href=/2020/03/25/Kubernetes-v1.18-%E6%AD%A3%E5%BC%8F%E5%8F%91%E5%B8%83%E6%8A%A2%E5%85%88%E4%B8%80%E8%A7%88/>Kubernetes v1.18 正式发布！抢先一览</a></h1><div class=post-meta><span class=post-time>2020-03-25</span></div></header><div class=post-content><div class=post-summary>持续关注 「K8S 生态周报」的小伙伴们，在每周的上游进展中，应该已经了解到了大多数新的特性和修复，这里来一并总结下。
Kubernetes 即将发布，截至发文时，v1.18.0 尚未正式 Release 。不过已经在进行中了， 让我们抢先看看 Kubernetes v1.18 为我们带来了哪些新内容吧！
v1.18 中的主要变更集中在 deprecations, metrics , kubectl 和 node 方面。我们逐个来看看：
kubectl 相关变更 引用我在K8S 生态周报| Helm v3.1.2 发布中的介绍：
#88004 正式添加了 kubectl alpha debug 命令，可通过此命令来调试 Kubernetes 中的资源，不过也请注意，此命令尚在 alpha 阶段，后续还会有变动。 引用我在K8S 生态周报| containerd v1.2.13 发布 中的介绍：
#87714 kubectl 的 --server-dry-run 被标记为废弃，并且可以通过使用 --dry-run=server 替代。并且 kubectl 的 --dry-run 参数接收的值，也变成了 client, server 以及 none。示例如下： (MoeLove) ➜ ~ kubectl create deploy moelove --image=redis --dry-run=client deployment.</div><div class=read-more><a href=/2020/03/25/Kubernetes-v1.18-%E6%AD%A3%E5%BC%8F%E5%8F%91%E5%B8%83%E6%8A%A2%E5%85%88%E4%B8%80%E8%A7%88/ class=read-more-link>阅读更多</a></div></div></article><article class=post><header class=post-header><h1 class=post-title><a class=post-link href=/2020/03/22/K8S-%E7%94%9F%E6%80%81%E5%91%A8%E6%8A%A5-%E9%A6%96%E4%B8%AA-Docker-%E5%AE%98%E6%96%B9-Action-%E5%8F%91%E5%B8%83/>K8S 生态周报| 首个 Docker 官方 Action 发布</a></h1><div class=post-meta><span class=post-time>2020-03-22</span></div></header><div class=post-content><div class=post-summary>「K8S 生态周报」内容主要包含我所接触到的 K8S 生态相关的每周值得推荐的一些信息。欢迎订阅知乎专栏「k8s生态」。
首个 Docker 官方 GitHub Action 发布了 从去年 Docker 将企业服务相关的业务出售给 Mirantis 之后，Docker 将重心放在助力开发者体验上，并为此做了一系列的努力。 包括 1 月份发布了 Docker Desktop v2.2 ，提供了 WSL2 的新架构，以及新的交互式 Desktop Dashboard 等特性。
本周又发布了首个 Docker GitHub Action，简化了 CI/CD 的流程。
这其实也是从另一个角度来推进 DockerHub 的普及（比预期的晚了一些）。DockerHub 上一直都有构建 Docker 镜像的功能，但我个人感觉体验并不够好，从一般意义上来说，它不够灵活；另外我感觉它的调度略慢了一点（虽然现在在优化中了）。
但本次发布的 Docker GitHub Action 可以让用户可以更灵活的通过 GitHub Action 来定义自己的 workflow，并将镜像推送至镜像仓库。这里的镜像仓库并没有和 DockerHub 强制绑定，用户可以自定义镜像仓库的地址。
使用示例如下，完整的项目可参考 docker-github-action 。 需要额外注意的是， 如果你的仓库是公开的，请注意将自己的用户名密码等设置为 secrets ，可参考下方示例，以防泄漏。
- name: Build and push Docker images uses: docker/build-push-action@v1.0 with: # Username used to log in to a Docker registry.</div><div class=read-more><a href=/2020/03/22/K8S-%E7%94%9F%E6%80%81%E5%91%A8%E6%8A%A5-%E9%A6%96%E4%B8%AA-Docker-%E5%AE%98%E6%96%B9-Action-%E5%8F%91%E5%B8%83/ class=read-more-link>阅读更多</a></div></div></article><article class=post><header class=post-header><h1 class=post-title><a class=post-link href=/2020/03/21/K8S-%E7%94%9F%E6%80%81%E5%91%A8%E6%8A%A5%E4%B8%80%E5%91%A8%E5%B9%B4%E4%BA%86/>「K8S 生态周报」一周年了！</a></h1><div class=post-meta><span class=post-time>2020-03-21</span></div></header><div class=post-content><div class=post-summary>「K8S 生态周报」已经整整一年啦！感谢大家的关注和支持！
从 2019 年 3 月 25 日发布第一篇「K8S 生态周报」到今天已正好一年，已经发布了 52 篇内容。在这个特殊的日子里，很想与大家分享下我的感受,以及「K8S 生态周报」的初衷和发展。
缘起 凡是接触 K8S 生态或者容器生态的小伙伴都不难发现，整个生态中涉及的东西很多，每天有无数的新消息，新变化，稍不留神就会错过很多有价值的内容。
这是一个信息爆炸的时代，同时大多数人包括我在内应该也都会存在着一定的“焦虑”，所以面对着海量的信息总是希望能更快的筛选出有价值的内容。
在去年年初，我在做个人总结时发现，虽然我每天接触到的信息很多，但真正有价值的，或者说值得我花很多精力持续去关注的内容并没有那么多。
并且由于没有归档，光靠自己记忆的话，有些事情可能就忘记了。之后也许还会再次花费时间了解或学习相关的内容，这也是另一种形式的浪费。
于是「K8S 生态周报」就以这个思路开始发布了第一篇 K8S 生态周报| 2019.03.25~2019.03.31。
过程改进 第一篇「K8S 生态周报」发布后，我觉得这个事情是值得做的。同时为了能提升效率，简化一些人工操作（自动化才是第一生产力），所以周末抽空写了个工具，把周报加到了我的 TODO 中。
具体而言，由于多年参与开源项目，我比较习惯使用 GitHub 的 issue 来管理个人的 TODO，加上 GitHub 提供了 Project 管理的功能，所以它现在看起来是这个样子：
每周有自动执行的任务来帮助我管理这些 issue，并将其加入我的每周计划便于跟踪进度。每周「K8S 生态周报」的草稿也是在 issue 中完成的，到周末时，再将内容筛选整理并发布。
用于管理这类 issue 的任务，是托管在 GitLab 上的。执行情况如下：
这组工具已经稳定运行一年了，基本没做过什么调整，还是比较能提升我的效率的。
发展阶段 「K8S 生态周报」一开始只发布在我的博客，公众号（MoeLove）、知乎专栏和掘金上，后来增加了SegmentFault和微博。也收获了很多小伙伴的支持和反馈。
上个月考虑到文字版不够详尽，所以在我家小可爱的支持下，增加了 内容更详细的视频版，同步发布在 BiliBili，西瓜视频和微信视频号上。感谢我的小可爱~
收获 简单的分享下现在的「K8S 生态周报」的数据，基本情况如下：
可以看到非常符合我周报的更新频率，每周有明显的波动。我一直保持在周一的早上在公众号进行推送。
这些数据意义不大，只不过看着数据上涨，知道自己写的内容被更多人看到了，也会有些开心，所以我这里也就只是分享个趋势。
真正的收获有以下几项：
周报我一直坚持没有断更，所以算是用另一种方式强迫我解决了之前信息没有「归档」的这个问题； 另外，由于要把内容讲清楚明白，所以也更加深了对信息印象和理解； 个人时间比较少，要抽时间写完整的文章会比较麻烦，通过周报的形式，也可以顺便把自己想说的内容稍微加进去，也方便了很多； 去年参加 KubeCon 的时候，还有小伙伴说每周都在坚持看我的「K8S 生态周报」，嘿嘿~； 开了交流群，也有不少小伙伴的加入； 在大量信息中能快速的筛选出有效信息，并对其持续关注，对个人成长有很大好处； 展望 「K8S 生态周报」内容主要包含我所接触到的 K8S 生态相关的每周值得推荐的一些信息。欢迎订阅知乎专栏「k8s生态」。</div><div class=read-more><a href=/2020/03/21/K8S-%E7%94%9F%E6%80%81%E5%91%A8%E6%8A%A5%E4%B8%80%E5%91%A8%E5%B9%B4%E4%BA%86/ class=read-more-link>阅读更多</a></div></div></article><article class=post><header class=post-header><h1 class=post-title><a class=post-link href=/2020/03/15/K8S-%E7%94%9F%E6%80%81%E5%91%A8%E6%8A%A5-Helm-v3.1.2-%E5%8F%91%E5%B8%83/>K8S 生态周报| Helm v3.1.2 发布</a></h1><div class=post-meta><span class=post-time>2020-03-15</span></div></header><div class=post-content><div class=post-summary>「K8S 生态周报」内容主要包含我所接触到的 K8S 生态相关的每周值得推荐的一些信息。欢迎订阅知乎专栏「k8s生态」。
Docker CE v19.03.8 发布 这是一个临时增加的安全更新版本，主要用于改进之前版本中对 CVE-2019-14271 的修复措施。
在去年 9 月份，我发布的 K8S 生态周报| Harbor v1.9 带来众多新特性 一文中，我曾介绍过 Docker v19.03.1 的发布主要也是为了修复 CVE-2019-14271 漏洞。
尽管这是一个安全更新版本，但我并不建议你立马升级到此 v19.03.8 版本，除非你并没有用到 Docker 对文件系统识别相关的功能。详情请参考我上周发布的周报 K8S 生态周报| Docker v19.03.7 发布。
简单来说就是在 v19.03.7 中，执行 docker info 命令的时候，会看到 Backing Filesystem 显示为 unknown 的情况。
该问题我已经修复，原计划在 v19.03.8 中发布，不过恰逢此安全更新版本，所以现在推迟到了 v19.03.9 版本中发布，敬请期待。
Helm v3.1.2 发布 Helm 于本周发布了 v3.1.2 版本，此版本是 Helm v3.1 的第二个 bugfix 版本。在此版本中有两个值得注意的内容：
#7674 当使用 APIVersionV2 时，执行 helm package 会将 Chart.</div><div class=read-more><a href=/2020/03/15/K8S-%E7%94%9F%E6%80%81%E5%91%A8%E6%8A%A5-Helm-v3.1.2-%E5%8F%91%E5%B8%83/ class=read-more-link>阅读更多</a></div></div></article><article class=post><header class=post-header><h1 class=post-title><a class=post-link href=/2020/03/08/K8S-%E7%94%9F%E6%80%81%E5%91%A8%E6%8A%A5-Docker-v19.03.7-%E5%8F%91%E5%B8%83/>K8S 生态周报| Docker v19.03.7 发布</a></h1><div class=post-meta><span class=post-time>2020-03-08</span></div></header><div class=post-content><div class=post-summary>「K8S 生态周报」内容主要包含我所接触到的 K8S 生态相关的每周值得推荐的一些信息。欢迎订阅知乎专栏「k8s生态」。
Docker v19.03.7 发布 我在之前的两次周报 《K8S 生态周报| Docker CE v19.03.6 正式发布》 和《K8S 生态周报| containerd v1.2.13 发布》 中已经介绍过了 Docker CE v19.03.6 在单核机器上 会由于 containerd 中的一个 bug 导致任务 hang 住。本周发布的 v19.03.7 已经将默认的 containerd 版本升级至 v1.2.13 ，该版本中包含了对此 bug 的修复。
此外这个版本中还包含了一个小的优化，可以让 docker stats 比之前的启动速度更快一点，直观上的感受目前可能还不是很明显。但如果是针对于某些特殊需求，需要采集使用量分析的时候，那就会比较明显了。
注意 升级到此版本后, 如果你在使用 overlay2 存储驱动时，可能会有人在执行 docker info 时，Backing Filesystem 那一栏显示会有点问题，这是因为代码里面移除了一些文件系统的检查逻辑，导致赋值也有些问题，之后会做修复。
你可能会得到类似下面的输出，不用太紧张。（如果你没有使用 Storage 相关配置的话，没太大影响的）
(MoeLove) ➜ ~ docker info --format '{{ index .DriverStatus 0 }}' [Backing Filesystem &lt;unknown>] 更新：我已经将它进行了修复，会包含在 Docker v19.</div><div class=read-more><a href=/2020/03/08/K8S-%E7%94%9F%E6%80%81%E5%91%A8%E6%8A%A5-Docker-v19.03.7-%E5%8F%91%E5%B8%83/ class=read-more-link>阅读更多</a></div></div></article><article class=post><header class=post-header><h1 class=post-title><a class=post-link href=/2020/02/29/K8S-%E7%94%9F%E6%80%81%E5%91%A8%E6%8A%A5-rkt-%E9%A1%B9%E7%9B%AE%E6%AD%A3%E5%BC%8F%E5%BD%92%E6%A1%A3%E5%B9%B6%E5%AE%A3%E5%B8%83%E7%BB%88%E6%AD%A2/>K8S 生态周报| rkt 项目正式归档并宣布终止</a></h1><div class=post-meta><span class=post-time>2020-02-29</span></div></header><div class=post-content><div class=post-summary>「K8S 生态周报」内容主要包含我所接触到的 K8S 生态相关的每周值得推荐的一些信息。欢迎订阅知乎专栏「k8s生态」。
rkt 项目正式归档并宣布终止 rkt 项目我在之前的周报《K8S 生态周报| rkt 项目正式被 CNCF 归档》 就已经详细介绍过了，这里不再赘述。
从去年 rkt 项目正式被 CNCF 归档后，直到现在 rkt 项目的维护者们也终于在 GitHub 上归档该项目，并宣布此项目正式终止。
公告信息请参考 rkt/rkt@bbd90a1 。
再次感谢 rkt 在容器生态领域做出的贡献！（大概以后也不会再提到 rkt 了）
Kubernetes NGINX Ingress 发布 v0.30.0 Kuberentes NGINX Ingress 近期相继发布了 v0.29 和 v0.30 两个版本，变更较频繁。主要值得注意的内容如下：
NGINX 升级到了 v1.17.8 版本； 允许 ExternalName 类型的 service 有不同的 port 和 targetPort（这是一个 bugfix）; 顺便聊个无关紧要的内容，这个版本中有一个 commit 比较有趣，请看 #5041 。这个 commit 其实是由一个 bot 生成的，专门用来做图片优化的应用， 通过这个 ImgBot 使得该项目中图片资源的体积减少了 36.</div><div class=read-more><a href=/2020/02/29/K8S-%E7%94%9F%E6%80%81%E5%91%A8%E6%8A%A5-rkt-%E9%A1%B9%E7%9B%AE%E6%AD%A3%E5%BC%8F%E5%BD%92%E6%A1%A3%E5%B9%B6%E5%AE%A3%E5%B8%83%E7%BB%88%E6%AD%A2/ class=read-more-link>阅读更多</a></div></div></article><article class=post><header class=post-header><h1 class=post-title><a class=post-link href=/2020/02/23/K8S-%E7%94%9F%E6%80%81%E5%91%A8%E6%8A%A5-containerd-v1.2.13-%E5%8F%91%E5%B8%83/>K8S 生态周报| containerd v1.2.13 发布</a></h1><div class=post-meta><span class=post-time>2020-02-23</span></div></header><div class=post-content><div class=post-summary>「K8S 生态周报」内容主要包含我所接触到的 K8S 生态相关的每周值得推荐的一些信息。欢迎订阅知乎专栏「k8s生态」。
containerd v1.2.13 发布 上周的 K8S 生态周报 中，我在 Docker CE v19.03.6 正式发布 的部分，介绍了 Docker v19.03.6 在单核的机器/虚拟机中，可能会由于 containerd 的一个 bug 导致任务 hang 住。
本周 containerd v1.2.13 发布了，此版本中已经包含了对该内容的修复。
如果受到此问题影响的用户， 可直接下载安装使用 containerd v1.2.13 以修复此问题。
近期 Docker v19.03.7 也将发布，将会默认使用 containerd v1.2.13 ，届时直接重装/升级均可规避此问题。
Helm v3.1.1 发布 上周 Helm 3.1.0 刚发布便马上迎来了 v3.1.1 版本，这是一个 bugfix 版本，包含了几个主要的修复：
修复了 helm list 不能正确抛出错误信息的问题，原因是代码中有个错误未被捕获； 现在，如果设置了 --wait 参数时，service 不会等待 externalIPs 便可以返回了，可规避一些类似 helm upgrade --wait 时可能超时的问题； 上游进展 #87714 kubectl 的 --server-dry-run 被标记为废弃，并且可以通过使用 --dry-run=server 替代。并且 kubectl 的 --dry-run 参数接收的值，也变成了 client, server 以及 none； #86810 kubeadm config images list 实现了结构化输出，支持文本，JSON，YAML 和 GO 模板等。（我个人认为，这个功能不错的，但目前我还没想到什么情况下我会需要它）； #87975 kubeadm upgrade node config 从 v1.</div><div class=read-more><a href=/2020/02/23/K8S-%E7%94%9F%E6%80%81%E5%91%A8%E6%8A%A5-containerd-v1.2.13-%E5%8F%91%E5%B8%83/ class=read-more-link>阅读更多</a></div></div></article><article class=post><header class=post-header><h1 class=post-title><a class=post-link href=/2020/02/15/K8S-%E7%94%9F%E6%80%81%E5%91%A8%E6%8A%A5-Helm-v3.1.0-%E6%AD%A3%E5%BC%8F%E5%8F%91%E5%B8%83/>K8S 生态周报| Helm v3.1.0 正式发布</a></h1><div class=post-meta><span class=post-time>2020-02-15</span></div></header><div class=post-content><div class=post-summary>「K8S 生态周报」内容主要包含我所接触到的 K8S 生态相关的每周值得推荐的一些信息。欢迎订阅知乎专栏「k8s生态」。
Docker CE v19.03.6 正式发布 在上次的周报 K8S 生态周报| Docker v19.03.6-rc2 发布 中，我已经介绍了 Docker v19.03.6 中包含的主要更新了。
这里我要额外增加一点提醒：
如果你在使用单核的机器/虚拟机，在升级 v19.03.6 后，可能会由于 containerd 中的一个 bug 而导致任务 hang 住
比较常见的一个可能出错的地方就是使用 GitLab.com 的共享 runner （单核的 vm），如果你没有将 dind（Docker In Docker）镜像指定为具体的版本号，而是使用类似 docker:dind 这样的 tag 时，你可能已经遇到相关的问题了。推荐当前固定为 docker:19.03.5-dind ，待后续修正。
containerd v1.2.13 中将会包含此修复（尚未发布），或者临时解决办法可以是暂时降级 containerd 。
当 container 发布新版本后，可以通过重新安装/升级 containerd 来解决此问题。
Helm v3.1.0 正式发布 自 2019 年 11 月 13 日 Helm 正式发布 v3.0.0 至今已过了三个月，Helm 终于迎来了新的特性版本， v3.</div><div class=read-more><a href=/2020/02/15/K8S-%E7%94%9F%E6%80%81%E5%91%A8%E6%8A%A5-Helm-v3.1.0-%E6%AD%A3%E5%BC%8F%E5%8F%91%E5%B8%83/ class=read-more-link>阅读更多</a></div></div></article><article class=post><header class=post-header><h1 class=post-title><a class=post-link href=/2020/02/09/K8S-%E7%94%9F%E6%80%81%E5%91%A8%E6%8A%A5-Docker-v19.03.6-rc2-%E5%8F%91%E5%B8%83/>K8S 生态周报| Docker v19.03.6-rc2 发布</a></h1><div class=post-meta><span class=post-time>2020-02-09</span></div></header><div class=post-content><div class=post-summary>「K8S 生态周报」内容主要包含我所接触到的 K8S 生态相关的每周值得推荐的一些信息。欢迎订阅知乎专栏「k8s生态」。
Docker v19.03.6-rc2 发布 自 2019 年 11 月 15 日 Docker v19.03.5 发布后，Docker Inc. 包括社区都发生了不少的变化。
v19.03.6 将会是 v19.03 系列的下一个 bugfix 版本。在此版本中，有几个比较值得注意的内容：
buildkit: 修复了在触发 ONBUILD 规则之后，未清理掉 ONBUILD 规则的问题。对于依赖 ONBUILD 指令，且使用 buildkit 的用户而言是个重要修复； buildkit: 修复了启用了 userns 时，可能导致权限错误的问题； 使用了 libnetwork 的短 ID, 以避免遇到 UNIX_PATH_MAX 的错误; 说到这个问题，其实也蛮有趣的，可能不少人都遇到过类似的问题。当然我也想在这个 UNIX_PATH_MAX 的问题上稍微多聊一点。
这个问题其实在四五年前我在 Docker 项目中其他的部分就遇到过，解决起来也简单就是缩短路径长度即可。但你可能会好奇，要缩短到什么程度呢？多长是合理值呢？
其实这个问题要深究的话，背后有蛮多历史的，这里我先跳过。我主要说下目前的限制是什么，这个限制可以在 Linux 的源码中找到的。
// include/uapi/linux/un.h #ifndef _LINUX_UN_H #define _LINUX_UN_H #include &lt;linux/socket.h> #define UNIX_PATH_MAX 108 struct sockaddr_un { __kernel_sa_family_t sun_family; /* AF_UNIX */ char sun_path[UNIX_PATH_MAX]; /* pathname */ }; #define SIOCUNIXFILE (SIOCPROTOPRIVATE + 0) /* open a socket file with O_PATH */ #endif /* _LINUX_UN_H */ 可以看到现在头文件中定义的是 108 。（ 注意我此处使用的是 Linux 5.</div><div class=read-more><a href=/2020/02/09/K8S-%E7%94%9F%E6%80%81%E5%91%A8%E6%8A%A5-Docker-v19.03.6-rc2-%E5%8F%91%E5%B8%83/ class=read-more-link>阅读更多</a></div></div></article></section><nav class=pagination><a class=next href=/page/2/><span class=next-text>下一页</span>
<i class="iconfont icon-right"></i></a></nav></div></div></main><footer id=footer class=footer><div class=social-links><a href=mailto:zhangjintao9020@gmail.com class="iconfont icon-email" title=email></a><a href=https://twitter.com/BeierTao class="iconfont icon-twitter" title=twitter></a><a href=https://github.com/tao12345666333 class="iconfont icon-github" title=github></a><a href=http://weibo.com/9020taobeier class="iconfont icon-weibo" title=weibo></a><a href=https://www.zhihu.com/people/TaoBeier class="iconfont icon-zhihu" title=zhihu></a><a href=https://moelove.info/index.xml type=application/rss+xml class="iconfont icon-rss" title=rss></a></div><div class=copyright><span class=power-by>由 <a class=hexo-link href=https://gohugo.io>Hugo</a> 强力驱动</span>
<span class=division>|</span>
<span class=theme-info>主题 -
<a class=theme-link href=https://github.com/olOwOlo/hugo-theme-even>Even</a></span>
<span class=copyright-year>&copy;
2013 -
2020
<span class=heart><i class="iconfont icon-heart"></i></span><span class=author>张晋涛</span></span></div></footer><div class=back-to-top id=back-to-top><i class="iconfont icon-up"></i></div></div><script src="/lib/highlight/highlight.pack.js?v=20171001"></script><script type=text/javascript src=/lib/jquery/jquery-3.2.1.min.js></script><script type=text/javascript src=/lib/slideout/slideout-1.0.1.min.js></script><script type=text/javascript src=/lib/fancybox/jquery.fancybox-3.1.20.min.js></script><script type=text/javascript src="/dist/even.min.js?v=3.2.0"></script></body></html>